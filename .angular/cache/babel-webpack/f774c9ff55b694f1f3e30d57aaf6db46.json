{"ast":null,"code":"import { Stomp } from '@stomp/stompjs';\nimport * as SockJS from \"sockjs-client\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/photo.service\";\nimport * as i2 from \"../../../services/album.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"../../../services/carousel.service\";\nimport * as i5 from \"@angular/material/icon\";\nimport * as i6 from \"../../../../../projects/angular-responsive-carousel/src/lib/carousel.component\";\nimport * as i7 from \"@angular/common\";\n\nfunction PhotosSliderComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵelement(1, \"img\", 4);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const photo_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", photo_r1.imageValue, i0.ɵɵsanitizeUrl);\n  }\n}\n\nexport let PhotosSliderComponent = /*#__PURE__*/(() => {\n  class PhotosSliderComponent {\n    constructor(photoService, albumService, router, route, carouselService) {\n      this.photoService = photoService;\n      this.albumService = albumService;\n      this.router = router;\n      this.route = route;\n      this.carouselService = carouselService;\n      this.height = 400;\n      this.photos = [];\n      this.stompClient = null;\n      this.isActionFromMe = false;\n    }\n\n    ngOnInit() {\n      this.route.params.subscribe(params => {\n        if (+params['id']) {\n          this.albumService.getAlbum(+params['id']).subscribe(album => {\n            this.photos = album.photos;\n          });\n        } else {\n          this.photoService.getPhotos().subscribe(photos => {\n            this.photos = photos;\n          });\n        }\n      });\n      this.connect();\n      this.carouselService.physicalActionPerformed.subscribe(value => {\n        this.sendAction(value);\n      });\n    }\n\n    onClose() {\n      this.router.navigate(['../'], {\n        relativeTo: this.route\n      });\n      this.photoService.photoSelectedSubject.next(null);\n    }\n\n    connect() {\n      const socket = new SockJS('/api/app-stomp-endpoint');\n      this.stompClient = Stomp.over(socket);\n\n      const _this = this;\n\n      this.stompClient.connect({}, function (frame) {\n        console.log('Connected: ' + frame);\n\n        _this.stompClient.subscribe('/show-photos/action-occurred', function (actionResponse) {\n          if (_this.isActionFromMe) {\n            _this.isActionFromMe = false;\n          } else {\n            _this.carouselService.performActionProgrammatically.next(actionResponse.body);\n\n            console.log(actionResponse.body);\n          }\n        });\n      });\n    }\n\n    disconnect() {\n      if (this.stompClient != null) {\n        this.stompClient.disconnect();\n      }\n\n      console.log('Disconnected!');\n    }\n\n    sendAction(value) {\n      this.stompClient.send('/app/do-action', {}, JSON.stringify({\n        'action': value\n      }));\n      this.isActionFromMe = true;\n    }\n\n    ngOnDestroy() {\n      this.disconnect();\n    }\n\n  }\n\n  PhotosSliderComponent.ɵfac = function PhotosSliderComponent_Factory(t) {\n    return new (t || PhotosSliderComponent)(i0.ɵɵdirectiveInject(i1.PhotoService), i0.ɵɵdirectiveInject(i2.AlbumService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.CarouselService));\n  };\n\n  PhotosSliderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PhotosSliderComponent,\n    selectors: [[\"app-photos-slider\"]],\n    inputs: {\n      height: \"height\",\n      photos: \"photos\"\n    },\n    decls: 6,\n    vars: 6,\n    consts: [[3, \"click\"], [3, \"objectFit\", \"cellWidth\", \"height\", \"dots\", \"loop\"], [\"class\", \"carousel-cell\", 4, \"ngFor\", \"ngForOf\"], [1, \"carousel-cell\"], [3, \"src\"]],\n    template: function PhotosSliderComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\");\n        i0.ɵɵelementStart(1, \"button\", 0);\n        i0.ɵɵlistener(\"click\", function PhotosSliderComponent_Template_button_click_1_listener() {\n          return ctx.onClose();\n        });\n        i0.ɵɵelementStart(2, \"mat-icon\");\n        i0.ɵɵtext(3, \"close\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"carousel\", 1);\n        i0.ɵɵtemplate(5, PhotosSliderComponent_div_5_Template, 2, 1, \"div\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"objectFit\", \"cover\")(\"cellWidth\", \"100%\")(\"height\", ctx.height)(\"dots\", true)(\"loop\", true);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.photos);\n      }\n    },\n    directives: [i5.MatIcon, i6.CarouselComponent, i7.NgForOf],\n    styles: [\"\"]\n  });\n  return PhotosSliderComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}